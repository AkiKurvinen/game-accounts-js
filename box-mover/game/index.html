<!DOCTYPE html>
<html>

<head>
    <script src="https://cdn.jsdelivr.net/npm/phaser@3.60.0/dist/phaser-arcade-physics.min.js"></script>
</head>

<body>
    <script>
        let locationtxt;
        let box_location = [0, 0]
        let user_id = 123;

        class Example extends Phaser.Scene {
            constructor() {
                super();
            }

            preload() {
                this.load.image('rocket', 'img/steelbox.png');
            }
            async getTopScores() {
                const json = { "user_id": user_id, "box_location": box_location }

                console.log("Call API", json)
            }

            create() {
                this.add.text(16, 16, 'Drag the Box').setFontSize(24).setShadow(1, 1);
                locationtxt = this.add.text(16, 64, `X: 0 - Y: 0`).setFontSize(24).setShadow(1, 1);

                const container = this.add.container(400, 300);

                // A container must have a size in order to receive input
                container.setSize(120, 80);
                container.setInteractive({ draggable: true });
                const rocket = this.add.sprite(0, 0, 'rocket', 'rocket');

                container.add([rocket]);
                locationtxt.setText(`X: ${container.x} - Y: ${container.y}`)
                container.on('drag', (pointer, dragX, dragY) => {
                    container.setPosition(dragX, dragY)
                    box_location = [dragX, dragY]
                    locationtxt.setText(`X: ${dragX} - Y: ${dragY}`)
                });

                // button call API

                const button = this.add.text(700, 550, 'Save position', {
                    fontFamily: 'Arial',
                    fontSize: '16px',
                    color: '#ffffff',
                    align: 'center',
                    fixedWidth: 120,
                    backgroundColor: '#2d2d2d'
                }).setPadding(8).setOrigin(0.5);

                button.setInteractive({ useHandCursor: true });

                button.on('pointerover', () => {
                    button.setBackgroundColor('#8d8d8d');
                });

                button.on('pointerout', () => {
                    button.setBackgroundColor('#2d2d2d');
                });

                button.on('pointerdown', () => {
                    button.setBackgroundColor('#000');
                    this.getTopScores()
                });


            }

        }

        const config = {
            type: Phaser.AUTO,
            width: 800,
            height: 600,
            parent: 'phaser-example',
            scene: Example
        };

        const game = new Phaser.Game(config);
    </script>

</body>

</html>